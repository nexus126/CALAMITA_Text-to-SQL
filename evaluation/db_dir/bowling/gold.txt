SELECT cognome_giocatore,email FROM giocatore;	bowling
SELECT nome_giocatore,cognome_giocatore,email,telefono FROM giocatore WHERE data_di_nascita >= '1990-01-01';  	bowling
SELECT giocatore, COUNT(*) AS num_partite FROM partita GROUP BY giocatore HAVING num_partite>1;	bowling
SELECT tenuta_il, COUNT(*) as num_partite FROM partita GROUP BY tenuta_il;	bowling
SELECT nome_giocatore, cognome_giocatore, MAX(tot_score) FROM giocatore LEFT JOIN partita ON giocatore.id_giocatore = partita.giocatore GROUP BY giocatore.id_giocatore;	bowling
SELECT partita.giocatore, cognome_giocatore, COUNT(*) FROM giocatore LEFT JOIN partita ON giocatore.id_giocatore = partita.giocatore GROUP BY giocatore.id_giocatore;	bowling
SELECT g.nome_giocatore,g.data_di_nascita,s.taglia FROM giocatore g INNER JOIN noleggio n ON g.id_giocatore = n.giocatore INNER JOIN scarpe s ON n.id_scarpe = s.id_scarpe WHERE s.marca = 'Nike';	bowling
SELECT nome_giocatore, cognome_giocatore, max_score FROM giocatore, (SELECT partita.giocatore as id_giocatore, MAX(tot_score) as max_score FROM partita GROUP BY partita.giocatore) as max_punteggi WHERE giocatore.id_giocatore = max_punteggi.id_giocatore AND max_score >= (SELECT AVG(tot_score) FROM partita);	bowling
SELECT DISTINCT marca,prezzo FROM scarpe WHERE taglia >= 42 and taglia <= 45;	bowling
SELECT ora_inizio,tenuta_il,id_pista, COUNT(*) as tot FROM `partita` GROUP BY ora_inizio,tenuta_il,id_pista;	bowling
SELECT id_impianto, COUNT(DISTINCT(`id_pista`)) FROM `pista` GROUP BY `id_impianto`;	bowling
SELECT COUNT(*) FROM `abbonamento` WHERE tipologia_abbonamento='annuale';	bowling
SELECT COUNT(*) FROM `giocatore` WHERE data_di_nascita>='1990-01-01';	bowling
SELECT COUNT(*) FROM `pista` WHERE id_impianto=101;	bowling
SELECT COUNT(*) FROM `scarpe` WHERE `taglia`=42;	bowling
SELECT SUM(prezzo) FROM `scarpe` WHERE marca='Nike';	bowling
SELECT giocatore.nome_giocatore, giocatore.cognome_giocatore FROM giocatore JOIN (SELECT partita.giocatore as id_giocatore, COUNT(*) as num_partite FROM `partita` JOIN abbonamento ON partita.giocatore = abbonamento.giocatore WHERE `tenuta_il`>='2022-01-01' AND `tenuta_il`<='2022-12-31' AND abbonamento.tipologia_abbonamento = 'annuale' GROUP BY partita.giocatore HAVING num_partite >=2) as partite_giocate ON giocatore.id_giocatore = partite_giocate.id_giocatore	bowling
SELECT giocatore.nome_giocatore, giocatore.cognome_giocatore FROM giocatore JOIN (SELECT partita.giocatore as id_giocatore, COUNT(*) as num_partite FROM `partita` JOIN abbonamento ON partita.giocatore = abbonamento.giocatore WHERE `tenuta_il`>='2022-01-01' AND `tenuta_il`<='2022-12-31' AND abbonamento.tipologia_abbonamento = 'annuale' GROUP BY partita.giocatore HAVING num_partite <5) as partite_giocate ON giocatore.id_giocatore = partite_giocate.id_giocatore	bowling
SELECT impianto_gettonato.id_impianto, pista.id_pista FROM pista JOIN (SELECT partite.id_impianto, COUNT(*) as giocate FROM (SELECT pista.id_impianto, partita.`ora_inizio`, partita.`tenuta_il`, partita.`id_pista` FROM `partita` JOIN pista ON partita.id_pista = pista.id_pista WHERE partita.tenuta_il >= '2021-01-01' AND partita.tenuta_il <= '2021-12-31' GROUP BY pista.id_impianto, partita.`ora_inizio`, partita.`tenuta_il`, partita.`id_pista`) as partite GROUP BY partite.id_impianto ORDER BY giocate DESC LIMIT 1) as impianto_gettonato ON impianto_gettonato.id_impianto = pista.id_impianto WHERE pista.is_disponibile = 1 ORDER BY pista.id_pista	bowling
SELECT giocatore.id_giocatore, `nome_giocatore`, `cognome_giocatore` FROM `giocatore` JOIN partita ON partita.giocatore = giocatore.id_giocatore JOIN (SELECT partita.id_pista, partita.tenuta_il, partita.ora_inizio FROM partita JOIN giocatore ON partita.giocatore = giocatore.id_giocatore WHERE giocatore.nome_giocatore = 'Mario' AND giocatore.cognome_giocatore='Rossi' ) as partite_rossi ON partita.id_pista = partite_rossi.id_pista AND partita.tenuta_il = partite_rossi.tenuta_il AND partite_rossi.ora_inizio = partita.ora_inizio GROUP BY giocatore.id_giocatore;	bowling
SELECT scarpe.marca, COUNT(*) FROM `noleggio` JOIN scarpe ON scarpe.id_scarpe = noleggio.id_scarpe JOIN abbonamento ON abbonamento.giocatore = noleggio.giocatore WHERE abbonamento.tipologia_abbonamento = 'annuale' GROUP BY scarpe.marca	bowling
SELECT pista.id_impianto, YEAR(`data_di_nascita`) as anno, COUNT(*) FROM `giocatore` JOIN partita ON partita.giocatore = giocatore.id_giocatore JOIN pista ON partita.id_pista = pista.id_pista GROUP BY anno, pista.id_impianto	bowling
SELECT scarpe.marca, YEAR(`data_di_nascita`) as anno, COUNT(*) FROM `giocatore` JOIN noleggio ON noleggio.giocatore = giocatore.id_giocatore JOIN scarpe ON scarpe.id_scarpe = noleggio.id_scarpe GROUP BY anno, scarpe.marca	bowling
SELECT giocatore.nome_giocatore, giocatore.cognome_giocatore, COUNT(*) FROM `abbonamento` JOIN giocatore ON giocatore.id_giocatore = abbonamento.giocatore JOIN partita ON giocatore.id_giocatore = partita.giocatore WHERE abbonamento.tipologia_abbonamento = 'annuale' GROUP BY giocatore.id_giocatore;	bowling
